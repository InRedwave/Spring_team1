<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team01.myapp.admin.dao.IAdminRepository">
	<select id="getUserListBySubject" parameterType="map"
		resultType="com.team01.myapp.admin.model.UserList">
		<![CDATA[
		
		select 
			 rownum,
		    u_id as "userId",
			u_name as "userName",
			major ,
			grade,
			subject_name as "subjectName" 
			from(
				select 
					rownum as rnum,
		            u_id ,
					u_name,
					major,
					grade,
					subject_name 
				from(
				select       
					u_id ,
					u_name,
					major,
					grade,
					subject_name  
						from(
						    select 
						        u_id ,
								u_name,
								major,
								grade,
								s.subject_name
				            from users u, subject s 
				            where #{subjectId} = s.subject_id and u.subject_id = #{subjectId}
				        )
				order by grade desc, u_id asc
				) 
				where rownum <= #{end}
				) 
				where rnum >= #{start}
		]]>

	</select>
	
	<select id="selectMaxListNo" resultType="int">
		<![CDATA[
			select nvl(max(u_id),0) as "userId" from users
		]]>
	</select>
</mapper>